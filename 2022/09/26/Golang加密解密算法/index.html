<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="keywords" content="Hexo Theme Redefine"><meta name="author" content="流转"><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="canonical" href="https://hybpjx.cn/2022/09/26/golang加密解密算法/"><meta name="robots" content="index,follow"><meta name="googlebot" content="index,follow"><meta name="revisit-after" content="1 days"><meta name="description" content="md5 加密——不可逆MD5信息摘要算法是一种被广泛使用的密码散列函数，可以产生出一个128位（16进制，32个字符）的散列值（hash value），用于确保信息传输完整一致。 12345import ( &quot;crypto&#x2F;md5&quot; &quot;encoding&#x2F;hex&quot; &quot;fmt&quot;) 第一种1234567&#x2F;&#x2F; MD5Str md5验证func"><meta property="og:type" content="article"><meta property="og:title" content="Golang加密解密算法"><meta property="og:url" content="https://hybpjx.cn/2022/09/26/Golang%E5%8A%A0%E5%AF%86%E8%A7%A3%E5%AF%86%E7%AE%97%E6%B3%95/index.html"><meta property="og:site_name" content="始識’s 博客"><meta property="og:description" content="md5 加密——不可逆MD5信息摘要算法是一种被广泛使用的密码散列函数，可以产生出一个128位（16进制，32个字符）的散列值（hash value），用于确保信息传输完整一致。 12345import ( &quot;crypto&#x2F;md5&quot; &quot;encoding&#x2F;hex&quot; &quot;fmt&quot;) 第一种1234567&#x2F;&#x2F; MD5Str md5验证func"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/12843286/1662199524599-a6b77cb9-25c9-4f5b-99c2-493ab50bb7ec.png#clientId=uae04fe37-f91f-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=ub1ee8990&margin=%5Bobject%20Object%5D&name=image.png&originHeight=3573&originWidth=1993&originalType=url&ratio=1&rotation=0&showTitle=false&size=1304823&status=done&style=none&taskId=u8b08ff15-15f1-45c8-b63a-6e18c32ee86&title="><meta property="article:published_time" content="2022-09-26T09:06:57.000Z"><meta property="article:modified_time" content="2024-08-28T08:10:06.563Z"><meta property="article:author" content="hybpjx"><meta property="article:tag" content="Golang"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://cdn.nlark.com/yuque/0/2022/png/12843286/1662199524599-a6b77cb9-25c9-4f5b-99c2-493ab50bb7ec.png#clientId=uae04fe37-f91f-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=ub1ee8990&margin=%5Bobject%20Object%5D&name=image.png&originHeight=3573&originWidth=1993&originalType=url&ratio=1&rotation=0&showTitle=false&size=1304823&status=done&style=none&taskId=u8b08ff15-15f1-45c8-b63a-6e18c32ee86&title="><link rel="icon" type="image/png" href="/images/hybpjx.svg" sizes="192x192"><link rel="apple-touch-icon" sizes="180x180" href="/images/hybpjx.svg"><meta name="theme-color" content="#A31F34"><link rel="shortcut icon" href="/images/hybpjx.svg"><title>Golang加密解密算法 - 流转&#39;s 博客</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.6.4/source/fonts/Chillax/chillax.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.6.4/source/assets/build/styles.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.6.4/source/fonts/GeistMono/geist-mono.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.6.4/source/fonts/Geist/geist.css"><link href="" rel="stylesheet"><script src="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.6.4/source/js/libs/anime.min.js"></script><script id="hexo-configurations">window.config={hostname:"hybpjx.cn",root:"/",language:"zh-CN",path:"search.xml"},window.theme={articles:{style:{font_size:"16px",line_height:1.5,image_border_radius:"14px",image_alignment:"center",image_caption:!1,link_icon:!0,title_alignment:"left",headings_top_spacing:{h1:"3.2rem",h2:"2.4rem",h3:"1.9rem",h4:"1.6rem",h5:"1.4rem",h6:"1.3rem"}},word_count:{enable:!0,count:!0,min2read:!0},author_label:{enable:!0,auto:!1,list:[]},code_block:{copy:!0,style:"mac",font:{enable:!1,family:null,url:null}},toc:{enable:!0,max_depth:3,number:!0,expand:!0,init_open:!0},copyright:{enable:!0,default:"cc_by_nc_sa"},lazyload:!1,recommendation:{enable:!1,title:"文章推荐",limit:3,mobile_limit:2,placeholder:"/images/wallhaven-wqery6-light.webp",skip_dirs:[]}},colors:{primary:"#A31F34",secondary:null,default_mode:"dark"},global:{fonts:{chinese:{enable:!0,family:null,url:null},english:{enable:!1,family:null,url:null}},content_max_width:"1000px",sidebar_width:"210px",hover:{shadow:!0,scale:!1},scroll_progress:{bar:!0,percentage:!0},website_counter:{url:"https://cn.vercount.one/js",enable:!0,site_pv:!0,site_uv:!0,post_pv:!0},single_page:!0,preloader:!0,open_graph:!0,google_analytics:{enable:!1,id:null}},home_banner:{enable:!0,style:"fixed",image:{light:"/images/light.jpeg",dark:"/images/dark.jpeg"},title:"流转の日常纪录",subtitle:{text:["这个世界","你","我","都只是过客"],hitokoto:{enable:!1,api:"https://v1.hitokoto.cn"},typing_speed:100,backing_speed:80,starting_delay:500,backing_delay:1500,loop:!0,smart_backspace:!0},text_color:{light:"#eee",dark:"#d1d1b6"},text_style:{title_size:"2.8rem",subtitle_size:"1.5rem",line_height:1.2},custom_font:{enable:!1,family:null,url:null},social_links:{enable:!0,style:"default",links:{github:"http://github.com/hybpjx",weixin:"https://mp.weixin.qq.com/s/U1F7nCYSaeuNY5YLxWFOGg",zhihu:"https://www.zhihu.com/people/liu-zhuan-i",bilibili:"https://space.bilibili.com/481309876",weibo:"https://weibo.com/5868422298",email:"hybpjx@163.com"},qrs:{weixin:null}}},plugins:{feed:{enable:!0},aplayer:{enable:!0,type:"fixed",audios:[{name:"Something Just Like This",artist:"Coldplay",url:"https://evan.beee.top/music/Something%20Just%20Like%20This%20-%20The%20Chainsmokers%E3%80%81Coldplay.mp3",cover:"https://evan.beee.top/music/covers/Something_Just_Like_This.png.org/"}]},mermaid:{enable:!1,version:"9.3.0"}},version:"2.6.4",navbar:{auto_hide:!0,color:{left:"#f78736",right:"#367df7",transparency:35},width:{home:"1200px",pages:"1000px"},links:{Home:{path:"/",icon:"fa-regular fa-house"},Archives:{path:"/archives",icon:"fa-regular fa-archive"},Status:{path:"https://zichliang.top/",icon:"fa fa-globe"},Essays:{path:"/essays",icon:"fa-regular fa-chart-bar"},Masonry:{path:"/masonry/",icon:"fa-solid fa-image"},About:{icon:"fa-regular fa-user",submenus:{"我":"/about","个人博客":"https://cnblogs.com/zichliang",Friends:"/friends"}}},search:{enable:!0,preload:!0}},page_templates:{friends_column:2,tags_style:"blur"},home:{sidebar:{enable:!0,position:"left",first_item:"menu",announcement:null,show_on_mobile:!0,links:{"文章":{path:"/archives",icon:"fa-regular fa-archive"},"标签":{path:"/tags",icon:"fa-regular fa-tags"},"分类":{path:"/categories",icon:"fa-regular fa-folder"}}},article_date_format:"auto",categories:{enable:!0,limit:3},tags:{enable:!0,limit:3}},footerStart:"2024/8/22 11:45:14"},window.lang_ago={second:"%s 秒前",minute:"%s 分钟前",hour:"%s 小时前",day:"%s 天前",week:"%s 周前",month:"%s 个月前",year:"%s 年前"},window.data={masonry:!0}</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.6.4/source/fontawesome/fontawesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.6.4/source/fontawesome/brands.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.6.4/source/fontawesome/solid.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.6.4/source/fontawesome/regular.min.css"><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="始識’s 博客" type="application/atom+xml"></head><body><div class="progress-bar-container"><span class="scroll-progress-bar"></span> <span class="pjax-progress-bar"></span></div><style>:root{--preloader-background-color:#fff;--preloader-text-color:#000}@media (prefers-color-scheme:dark){:root{--preloader-background-color:#202124;--preloader-text-color:#fff}}@media (prefers-color-scheme:light){:root{--preloader-background-color:#fff;--preloader-text-color:#000}}@media (max-width:600px){.ml13{font-size:2.6rem!important}}.preloader{display:flex;flex-direction:column;gap:1rem;align-items:center;justify-content:center;position:fixed;padding:12px;top:0;right:0;bottom:0;left:0;width:100vw;height:100vh;background-color:var(--preloader-background-color);z-index:1100;transition:opacity .2s ease-in-out}.ml13{font-size:3.2rem;color:var(--preloader-text-color);letter-spacing:-1px;font-weight:500;font-family:Chillax-Variable,sans-serif;text-align:center}.ml13 .word{display:inline-flex;flex-wrap:wrap;white-space:nowrap}.ml13 .letter{display:inline-block;line-height:1em}</style><div class="preloader"><h2 class="ml13">流转&#39;s 博客</h2><script>var textWrapper = document.querySelector('.ml13');
        // Split text into words
        var words = textWrapper.textContent.trim().split(' ');

        // Clear the existing content
        textWrapper.innerHTML = '';

        // Wrap each word and its letters in spans
        words.forEach(function(word) {
            var wordSpan = document.createElement('span');
            wordSpan.classList.add('word');
            wordSpan.innerHTML = word.replace(/\S/g, "<span class='letter'>$&</span>");
            textWrapper.appendChild(wordSpan);
            textWrapper.appendChild(document.createTextNode(' ')); // Add space between words
        });

        var animation = anime.timeline({loop: true})
            .add({
                targets: '.ml13 .letter',
                translateY: [40,0],
                translateZ: 0,
                opacity: [0,1],
                filter: ['blur(5px)', 'blur(0px)'], // Starting from blurred to unblurred
                easing: "easeOutExpo",
                duration: 1400,
                delay: (el, i) => 300 + 30 * i,
            }).add({
                targets: '.ml13 .letter',
                translateY: [0,-40],
                opacity: [1,0],
                filter: ['blur(0px)', 'blur(5px)'], // Ending from unblurred to blurred
                easing: "easeInExpo",
                duration: 1200,
                delay: (el, i) => 100 + 30 * i,
                complete: function() {
                    hidePreloader(); // Call hidePreloader after the animation completes
                }
            });

        let themeStatus = JSON.parse(localStorage.getItem('REDEFINE-THEME-STATUS'))?.isDark;

        // If the theme status is not found in local storage, check the preferred color scheme
        if (themeStatus === undefined || themeStatus === null) {
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                themeStatus = 'dark';
            } else {
                themeStatus = 'light';
            }
        }

        // Now you can use the themeStatus variable in your code
        if (themeStatus) {
            document.documentElement.style.setProperty('--preloader-background-color', '#202124');
            document.documentElement.style.setProperty('--preloader-text-color', '#fff');
        } else {
            document.documentElement.style.setProperty('--preloader-background-color', '#fff');
            document.documentElement.style.setProperty('--preloader-text-color', '#000');
        }

        window.addEventListener('load', function () {
            setTimeout(hidePreloader, 5000); // Call hidePreloader after 5000 milliseconds if not already called by animation
        });

        function hidePreloader() {
            var preloader = document.querySelector('.preloader');
            preloader.style.opacity = '0';
            setTimeout(function () {
                preloader.style.display = 'none';
            }, 200);
        }</script></div><main class="page-container" id="swup"><div class="main-content-container"><div class="main-content-header"><header class="navbar-container px-6 md:px-12"><div class="navbar-content"><div class="left"><a class="logo-title" href="/">流转&#39;s 博客</a></div><div class="right"><div class="desktop"><ul class="navbar-list"><li class="navbar-item"><a href="/"><i class="fa-regular fa-house fa-fw"></i> 首页</a></li><li class="navbar-item"><a href="/archives"><i class="fa-regular fa-archive fa-fw"></i> 归档</a></li><li class="navbar-item"><a target="_blank" rel="noopener" href="https://zichliang.top/"><i class="fa fa-globe fa-fw"></i> 个人</a></li><li class="navbar-item"><a href="/essays"><i class="fa-regular fa-chart-bar fa-fw"></i> 说说</a></li><li class="navbar-item"><a href="/masonry/"><i class="fa-solid fa-image fa-fw"></i> 相册</a></li><li class="navbar-item"><a class="has-dropdown" href="#" onclick="&#34;return" false;&#34;><i class="fa-regular fa-user fa-fw"></i> 关于 <i class="fa-solid fa-chevron-down fa-fw"></i></a><ul class="sub-menu"><li><a href="/about">我</a></li><li><a target="_blank" rel="noopener" href="https://cnblogs.com/zichliang">个人博客</a></li><li><a href="/friends">友情链接</a></li></ul></li><li class="navbar-item search search-popup-trigger"><i class="fa-solid fa-magnifying-glass"></i></li></ul></div><div class="mobile"><div class="icon-item search search-popup-trigger"><i class="fa-solid fa-magnifying-glass"></i></div><div class="icon-item navbar-bar"><div class="navbar-bar-middle"></div></div></div></div></div><div class="navbar-drawer h-screen w-full absolute top-0 left-0 bg-background-color flex flex-col justify-between"><ul class="drawer-navbar-list flex flex-col px-4 justify-center items-start"><li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full"><a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full" href="/"><span>首页 </span><i class="fa-regular fa-house fa-sm fa-fw"></i></a></li><li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full"><a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full" href="/archives"><span>归档 </span><i class="fa-regular fa-archive fa-sm fa-fw"></i></a></li><li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full"><a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full" target="_blank" rel="noopener" href="https://zichliang.top/"><span>个人 </span><i class="fa fa-globe fa-sm fa-fw"></i></a></li><li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full"><a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full" href="/essays"><span>说说 </span><i class="fa-regular fa-chart-bar fa-sm fa-fw"></i></a></li><li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full"><a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full" href="/masonry/"><span>相册 </span><i class="fa-solid fa-image fa-sm fa-fw"></i></a></li><li class="drawer-navbar-item-sub text-base my-1.5 flex flex-col w-full"><div class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary cursor-pointer text-2xl font-semibold group border-b border-border-color hover:border-primary w-full" navbar-data-toggle="submenu-About"><span>关于 </span><i class="fa-solid fa-chevron-right fa-sm fa-fw transition-all"></i></div><div class="flex-col items-start px-2 py-2 hidden" data-target="submenu-About"><div class="drawer-navbar-item text-base flex flex-col justify-center items-start hover:underline active:underline hover:underline-offset-1 rounded-3xl"><a class="text-third-text-color text-xl" href="/about">我</a></div><div class="drawer-navbar-item text-base flex flex-col justify-center items-start hover:underline active:underline hover:underline-offset-1 rounded-3xl"><a class="text-third-text-color text-xl" target="_blank" rel="noopener" href="https://cnblogs.com/zichliang">个人博客</a></div><div class="drawer-navbar-item text-base flex flex-col justify-center items-start hover:underline active:underline hover:underline-offset-1 rounded-3xl"><a class="text-third-text-color text-xl" href="/friends">友情链接</a></div></div></li><li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full"><a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full active" href="/archives"><span>文章</span> <i class="fa-regular fa-archive fa-sm fa-fw"></i></a></li><li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full"><a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full active" href="/tags"><span>标签</span> <i class="fa-regular fa-tags fa-sm fa-fw"></i></a></li><li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full"><a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full active" href="/categories"><span>分类</span> <i class="fa-regular fa-folder fa-sm fa-fw"></i></a></li></ul><div class="statistics flex justify-around my-2.5"><a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/tags"><div class="number text-2xl sm:text-xl text-second-text-color font-semibold">7</div><div class="label text-third-text-color text-sm">标签</div></a><a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/categories"><div class="number text-2xl sm:text-xl text-second-text-color font-semibold">9</div><div class="label text-third-text-color text-sm">分类</div></a><a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/archives"><div class="number text-2xl sm:text-xl text-second-text-color font-semibold">24</div><div class="label text-third-text-color text-sm">文章</div></a></div></div><div class="window-mask"></div></header></div><div class="main-content-body"><div class="main-content"><div class="post-page-container flex relative justify-between box-border w-full h-full"><div class="article-content-container"><div class="article-title relative w-full"><div class="w-full flex items-center pt-6 justify-start"><h1 class="article-title-regular text-second-text-color tracking-tight text-4xl md:text-6xl font-semibold px-2 sm:px-6 md:px-8 py-3">Golang加密解密算法</h1></div></div><div class="article-header flex flex-row gap-2 items-center px-2 sm:px-6 md:px-8"><div class="avatar w-[46px] h-[46px] flex-shrink-0 rounded-medium border border-border-color p-[1px]"><img src="/images/hybpjx.svg"></div><div class="info flex flex-col justify-between"><div class="author flex items-center"><span class="name text-default-text-color text-lg font-semibold">流转</span> <span class="author-label ml-1.5 text-xs px-2 py-0.5 rounded-small text-third-text-color border border-shadow-color-1">Lv3</span></div><div class="meta-info"><div class="article-meta-info"><span class="article-date article-meta-item"><i class="fa-regular fa-pen-fancy"></i>&nbsp; <span class="desktop">2022-09-26 17:06:57</span> <span class="mobile">2022-09-26 17:06:57</span> <span class="hover-info">创建</span> </span><span class="article-date article-meta-item"><i class="fa-regular fa-wrench"></i>&nbsp; <span class="desktop">2024-08-28 16:10:06</span> <span class="mobile">2024-08-28 16:10:06</span> <span class="hover-info">更新</span> </span><span class="article-categories article-meta-item"><i class="fa-regular fa-folders"></i>&nbsp;<ul><li><a href="/categories/%E8%AF%AD%E8%A8%80%E5%8A%A0%E8%A7%A3%E5%AF%86/">语言加解密</a>&nbsp;</li></ul></span><span class="article-tags article-meta-item"><i class="fa-regular fa-tags"></i>&nbsp;<ul><li><a href="/tags/Golang/">Golang</a>&nbsp;</li></ul></span><span class="article-wordcount article-meta-item"><i class="fa-regular fa-typewriter"></i>&nbsp;<span>5.2k 字</span> </span><span class="article-min2read article-meta-item"><i class="fa-regular fa-clock"></i>&nbsp;<span>25 分钟</span> </span><span class="article-pv article-meta-item"><i class="fa-regular fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span></span></div></div></div></div><div class="article-content markdown-body px-2 sm:px-6 md:px-8 pb-8"><hr><h1 id="md5-加密——不可逆"><a href="#md5-加密——不可逆" class="headerlink" title="md5 加密——不可逆"></a>md5 加密——不可逆</h1><p>MD5信息摘要算法是一种被广泛使用的密码散列函数，可以产生出一个128位（16进制，32个字符）的散列值（hash value），用于确保信息传输完整一致。</p><div class="highlight-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> (</span><br><span class="line"> <span class="string">&quot;crypto/md5&quot;</span></span><br><span class="line"> <span class="string">&quot;encoding/hex&quot;</span></span><br><span class="line"> <span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure></div><h2 id="第一种"><a href="#第一种" class="headerlink" title="第一种"></a>第一种</h2><div class="highlight-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MD5Str md5验证</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">MD5Str</span><span class="params">(src <span class="type">string</span>)</span></span> <span class="type">string</span> &#123;</span><br><span class="line"> h := md5.New()</span><br><span class="line"> h.Write([]<span class="type">byte</span>(src)) <span class="comment">// 需要加密的字符串为</span></span><br><span class="line"> fmt.Printf(<span class="string">&quot;%s\n&quot;</span>, hex.EncodeToString(h.Sum(<span class="literal">nil</span>))) <span class="comment">// 输出加密结果</span></span><br><span class="line"> <span class="keyword">return</span> hex.EncodeToString(h.Sum(<span class="literal">nil</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h2 id="第二种"><a href="#第二种" class="headerlink" title="第二种"></a>第二种</h2><div class="highlight-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MD5Str2 md5验证</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">MD5Str2</span><span class="params">(src <span class="type">string</span>)</span></span> <span class="type">string</span> &#123;</span><br><span class="line"> <span class="keyword">return</span> fmt.Sprintf(<span class="string">&quot;%x&quot;</span>, md5.Sum([]<span class="type">byte</span>(src)))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h1 id="hmacsha-加密——不可逆"><a href="#hmacsha-加密——不可逆" class="headerlink" title="hmacsha 加密——不可逆"></a>hmacsha 加密——不可逆</h1><p>HMAC是密钥相关的哈希运算消息认证码（Hash-based Message Authentication Code）的缩写，<br>它通过一个标准算法，在计算哈希的过程中，把key混入计算过程中。<br>和我们自定义的加salt算法不同，Hmac算法针对所有哈希算法都通用，无论是MD5还是SHA-1。采用Hmac替代我们自己的salt算法，可以使程序算法更标准化，也更安全。</p><h2 id="hmac-md5加密"><a href="#hmac-md5加密" class="headerlink" title="hmac-md5加密"></a>hmac-md5加密</h2><div class="highlight-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//key随意设置 data 要加密数据</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Hmac</span><span class="params">(key, data <span class="type">string</span>)</span></span> <span class="type">string</span> &#123;</span><br><span class="line"> <span class="comment">// 创建对应的md5哈希加密算法</span></span><br><span class="line">    hash:= hmac.New(md5.New, []<span class="type">byte</span>(key)) </span><br><span class="line"></span><br><span class="line">    hash.Write([]<span class="type">byte</span>(data))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> hex.EncodeToString(hash.Sum([]<span class="type">byte</span>(<span class="string">&quot;&quot;</span>)))</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div><h2 id="hamacsha1-加密"><a href="#hamacsha1-加密" class="headerlink" title="hamacsha1 加密"></a>hamacsha1 加密</h2><div class="highlight-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// HmacSha1 hmacSha1加密 key随意设置 data 要加密数据</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">HmacSha1</span><span class="params">(src, key <span class="type">string</span>)</span></span> <span class="type">string</span> &#123;</span><br><span class="line"> m := hmac.New(sha1.New, []<span class="type">byte</span>(key))</span><br><span class="line"> m.Write([]<span class="type">byte</span>(src))</span><br><span class="line"> <span class="keyword">return</span> hex.EncodeToString(m.Sum(<span class="literal">nil</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h2 id="hamacsha-256-加密"><a href="#hamacsha-256-加密" class="headerlink" title="hamacsha 256 加密"></a>hamacsha 256 加密</h2><div class="highlight-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// HmacSHA256 hmacSha256验证  key随意设置 data 要加密数据</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">HmacSHA256</span><span class="params">(key, src <span class="type">string</span>)</span></span> <span class="type">string</span> &#123;</span><br><span class="line"> m := hmac.New(sha256.New, []<span class="type">byte</span>(key))</span><br><span class="line"> m.Write([]<span class="type">byte</span>(src))</span><br><span class="line"> <span class="keyword">return</span> hex.EncodeToString(m.Sum(<span class="literal">nil</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h2 id="hmacsha512加密"><a href="#hmacsha512加密" class="headerlink" title="hmacsha512加密"></a>hmacsha512加密</h2><div class="highlight-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// HmacSHA512 hmacSha512验证</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">HmacSHA512</span><span class="params">(key, src <span class="type">string</span>)</span></span> <span class="type">string</span> &#123;</span><br><span class="line"> m := hmac.New(sha512.New, []<span class="type">byte</span>(key))</span><br><span class="line"> m.Write([]<span class="type">byte</span>(src))</span><br><span class="line"> <span class="keyword">return</span> hex.EncodeToString(m.Sum(<span class="literal">nil</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h2 id="hamasha-调用"><a href="#hamasha-调用" class="headerlink" title="hamasha 调用"></a>hamasha 调用</h2><div class="highlight-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"> <span class="string">&quot;crypto/hmac&quot;</span></span><br><span class="line"> <span class="string">&quot;crypto/md5&quot;</span></span><br><span class="line"> <span class="string">&quot;crypto/sha1&quot;</span></span><br><span class="line"> <span class="string">&quot;crypto/sha256&quot;</span></span><br><span class="line"> <span class="string">&quot;crypto/sha512&quot;</span></span><br><span class="line"> <span class="string">&quot;encoding/hex&quot;</span></span><br><span class="line"> <span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Hmac hmac验证 key随意设置 data 要加密数据</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Hmac</span><span class="params">(key, data <span class="type">string</span>)</span></span> <span class="type">string</span> &#123;</span><br><span class="line"></span><br><span class="line"> hash := hmac.New(md5.New, []<span class="type">byte</span>(key)) <span class="comment">// 创建对应的md5哈希加密算法</span></span><br><span class="line"></span><br><span class="line"> hash.Write([]<span class="type">byte</span>(data))</span><br><span class="line"></span><br><span class="line"> <span class="keyword">return</span> hex.EncodeToString(hash.Sum([]<span class="type">byte</span>(<span class="string">&quot;&quot;</span>)))</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// HmacSHA256 hmacSha256加密  key随意设置 data 要加密数据</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">HmacSHA256</span><span class="params">(key, src <span class="type">string</span>)</span></span> <span class="type">string</span> &#123;</span><br><span class="line"> m := hmac.New(sha256.New, []<span class="type">byte</span>(key))</span><br><span class="line"> m.Write([]<span class="type">byte</span>(src))</span><br><span class="line"> <span class="keyword">return</span> hex.EncodeToString(m.Sum(<span class="literal">nil</span>))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// HmacSHA512 hmacSha512加密 key随意设置 data 要加密数据</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">HmacSHA512</span><span class="params">(key, src <span class="type">string</span>)</span></span> <span class="type">string</span> &#123;</span><br><span class="line"> m := hmac.New(sha512.New, []<span class="type">byte</span>(key))</span><br><span class="line"> m.Write([]<span class="type">byte</span>(src))</span><br><span class="line"> <span class="keyword">return</span> hex.EncodeToString(m.Sum(<span class="literal">nil</span>))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// HmacSha1 hmacSha1加密 key随意设置 data 要加密数据</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">HmacSha1</span><span class="params">(src, key <span class="type">string</span>)</span></span> <span class="type">string</span> &#123;</span><br><span class="line"> m := hmac.New(sha1.New, []<span class="type">byte</span>(key))</span><br><span class="line"> m.Write([]<span class="type">byte</span>(src))</span><br><span class="line"> <span class="keyword">return</span> hex.EncodeToString(m.Sum(<span class="literal">nil</span>))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// SHA256Str sha256加密</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">SHA256Str</span><span class="params">(src <span class="type">string</span>)</span></span> <span class="type">string</span> &#123;</span><br><span class="line"> h := sha256.New()</span><br><span class="line"> h.Write([]<span class="type">byte</span>(src)) <span class="comment">// 需要加密的字符串为</span></span><br><span class="line"> <span class="comment">// fmt.Printf(&quot;%s\n&quot;, hex.EncodeToString(h.Sum(nil))) // 输出加密结果</span></span><br><span class="line"> <span class="keyword">return</span> hex.EncodeToString(h.Sum(<span class="literal">nil</span>))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"> hmac_ := Hmac(<span class="string">&quot;hybpjx&quot;</span>, <span class="string">&quot;始識&quot;</span>)</span><br><span class="line"> hamcsha1 := HmacSha1(<span class="string">&quot;hybpjx&quot;</span>, <span class="string">&quot;始識&quot;</span>)</span><br><span class="line"> hamcsha256 := HmacSHA256(<span class="string">&quot;hybpjx&quot;</span>, <span class="string">&quot;始識&quot;</span>)</span><br><span class="line"> hamacsha512 := HmacSHA512(<span class="string">&quot;hybpjx&quot;</span>, <span class="string">&quot;始識&quot;</span>)</span><br><span class="line"> fmt.Println(hmac_)</span><br><span class="line"> fmt.Println(hamcsha1)</span><br><span class="line"> fmt.Println(hamcsha256)</span><br><span class="line"> fmt.Println(hamacsha512)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div><p>结果</p><blockquote><p>d8801f70df7891764116e1ac003f7189</p><p>60d68e01c8a86f3b87e4e147e9f0fadce2a69661</p><p>b3f8ddf991288036864761a55046877adfe4f78ec9a89bb63932af92689b139f</p><p>b9b1fca0fe91522482ee1b2161e57d67482af6ef371614365b918c31ce774f9126ed627e378a063145f404ff2de7bd84f8e4798c385662ef4749e58e9209ca63</p></blockquote><h1 id="Sha-加密——不可逆"><a href="#Sha-加密——不可逆" class="headerlink" title="Sha 加密——不可逆"></a>Sha 加密——不可逆</h1><h2 id="sha1"><a href="#sha1" class="headerlink" title="sha1"></a>sha1</h2><p>SHA-1可以生成一个被称为消息摘要的160位（20字节）散列值，散列值通常的呈现形式为40个十六进制数。</p><div class="highlight-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Sha1</span><span class="params">(data <span class="type">string</span>)</span></span> <span class="type">string</span> &#123;</span><br><span class="line"> sha1_ := sha1.New()</span><br><span class="line"> sha1_.Write([]<span class="type">byte</span>(data))</span><br><span class="line"> <span class="keyword">return</span> hex.EncodeToString(sha1_.Sum([]<span class="type">byte</span>(<span class="string">&quot;&quot;</span>)))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h2 id="sha256"><a href="#sha256" class="headerlink" title="sha256"></a>sha256</h2><p>SHA256算法使用的哈希值长度是256位。这是一个抽象类。此类的唯一实现是SHA256Managed。</p><div class="highlight-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// SHA256 sha256加密</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">SHA256</span><span class="params">(src <span class="type">string</span>)</span></span> <span class="type">string</span> &#123;</span><br><span class="line"> h := sha256.New()</span><br><span class="line"> <span class="comment">// 需要加密的字符串为</span></span><br><span class="line"> h.Write([]<span class="type">byte</span>(src))</span><br><span class="line"> <span class="comment">// fmt.Printf(&quot;%s\n&quot;, hex.EncodeToString(h.Sum(nil))) // 输出加密结果</span></span><br><span class="line"> <span class="keyword">return</span> hex.EncodeToString(h.Sum(<span class="literal">nil</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h2 id="sha512"><a href="#sha512" class="headerlink" title="sha512"></a>sha512</h2><p>SHA (Secure Hash Algorithm，译作安全散列算法) 是美国国家安全局 (NSA) 设计，美国国家标准与技术研究院 (NIST) 发布的一系列密码散列函数。</p><div class="highlight-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// SHA512 sha512加密</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">SHA512</span><span class="params">(src <span class="type">string</span>)</span></span> <span class="type">string</span> &#123;</span><br><span class="line"> h := sha512.New()</span><br><span class="line"> <span class="comment">// 需要加密的字符串为</span></span><br><span class="line"> h.Write([]<span class="type">byte</span>(src))</span><br><span class="line"> <span class="comment">// fmt.Printf(&quot;%s\n&quot;, hex.EncodeToString(h.Sum(nil))) // 输出加密结果</span></span><br><span class="line"> <span class="keyword">return</span> hex.EncodeToString(h.Sum(<span class="literal">nil</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h2 id="sha调用"><a href="#sha调用" class="headerlink" title="sha调用"></a>sha调用</h2><div class="highlight-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"> <span class="string">&quot;crypto/sha1&quot;</span></span><br><span class="line"> <span class="string">&quot;crypto/sha256&quot;</span></span><br><span class="line"> <span class="string">&quot;crypto/sha512&quot;</span></span><br><span class="line"> <span class="string">&quot;encoding/hex&quot;</span></span><br><span class="line"> <span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Sha1</span><span class="params">(data <span class="type">string</span>)</span></span> <span class="type">string</span> &#123;</span><br><span class="line"> sha1_ := sha1.New()</span><br><span class="line"> sha1_.Write([]<span class="type">byte</span>(data))</span><br><span class="line"> <span class="keyword">return</span> hex.EncodeToString(sha1_.Sum([]<span class="type">byte</span>(<span class="string">&quot;&quot;</span>)))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// SHA256 sha256加密</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">SHA256</span><span class="params">(src <span class="type">string</span>)</span></span> <span class="type">string</span> &#123;</span><br><span class="line"> h := sha256.New()</span><br><span class="line"> <span class="comment">// 需要加密的字符串为</span></span><br><span class="line"> h.Write([]<span class="type">byte</span>(src))</span><br><span class="line"> <span class="comment">// fmt.Printf(&quot;%s\n&quot;, hex.EncodeToString(h.Sum(nil))) // 输出加密结果</span></span><br><span class="line"> <span class="keyword">return</span> hex.EncodeToString(h.Sum(<span class="literal">nil</span>))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// SHA512 sha512加密</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">SHA512</span><span class="params">(src <span class="type">string</span>)</span></span> <span class="type">string</span> &#123;</span><br><span class="line"> h := sha512.New()</span><br><span class="line"> <span class="comment">// 需要加密的字符串为</span></span><br><span class="line"> h.Write([]<span class="type">byte</span>(src))</span><br><span class="line"> <span class="comment">// fmt.Printf(&quot;%s\n&quot;, hex.EncodeToString(h.Sum(nil))) // 输出加密结果</span></span><br><span class="line"> <span class="keyword">return</span> hex.EncodeToString(h.Sum(<span class="literal">nil</span>))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"> _sha1 := Sha1(<span class="string">&quot;始識&quot;</span>)</span><br><span class="line"> _sha256 := SHA256(<span class="string">&quot;始識&quot;</span>)</span><br><span class="line"> _sha512 := SHA512(<span class="string">&quot;始識&quot;</span>)</span><br><span class="line"> fmt.Println(_sha1)</span><br><span class="line"> fmt.Println(_sha256)</span><br><span class="line"> fmt.Println(_sha512)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>结果</p><blockquote><p>7bac01cc58a26f3cb280b0466794a89441279946</p><p>6ef99e6d3fe34a46afcdc438435728fe95ffdab18e389ddd31609edd6729b11d</p><p>0c04e9b79f488646d0eac6f65468248507939d643cc92709b14eb0d18d8f13db509ed5ccd3312d6c234408185a4611a42525dce9e8d32255640f56a2f836635a</p></blockquote><h1 id="base-加密-解密"><a href="#base-加密-解密" class="headerlink" title="base 加密 解密"></a>base 加密 解密</h1><h2 id="加密"><a href="#加密" class="headerlink" title="加密"></a>加密</h2><div class="highlight-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// BASE64StdEncode base编码</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">BASE64StdEncode</span><span class="params">(src <span class="type">string</span>)</span></span> <span class="type">string</span> &#123;</span><br><span class="line"> <span class="keyword">return</span> base64.StdEncoding.EncodeToString([]<span class="type">byte</span>(src))</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div><h2 id="解密"><a href="#解密" class="headerlink" title="解密"></a>解密</h2><div class="highlight-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// BASE64StdDecode base解码</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">BASE64StdDecode</span><span class="params">(src <span class="type">string</span>)</span></span> <span class="type">string</span> &#123;</span><br><span class="line"> a, err := base64.StdEncoding.DecodeString(src)</span><br><span class="line"> <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">  _ = fmt.Errorf(<span class="string">&quot;解密失败,%v\n&quot;</span>, err)</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">return</span> <span class="type">string</span>(a)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h2 id="base64-调用"><a href="#base64-调用" class="headerlink" title="base64  调用"></a>base64 调用</h2><div class="highlight-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"> <span class="string">&quot;encoding/base64&quot;</span></span><br><span class="line"> <span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// BASE64StdEncode base编码</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">BASE64StdEncode</span><span class="params">(src <span class="type">string</span>)</span></span> <span class="type">string</span> &#123;</span><br><span class="line"> <span class="keyword">return</span> base64.StdEncoding.EncodeToString([]<span class="type">byte</span>(src))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// BASE64StdDecode base解码</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">BASE64StdDecode</span><span class="params">(src <span class="type">string</span>)</span></span> <span class="type">string</span> &#123;</span><br><span class="line"> a, err := base64.StdEncoding.DecodeString(src)</span><br><span class="line"> <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">  _ = fmt.Errorf(<span class="string">&quot;解密失败,%v\n&quot;</span>, err)</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">return</span> <span class="type">string</span>(a)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"> encodeBase64 := BASE64StdEncode(<span class="string">&quot;hybpjx&quot;</span>)</span><br><span class="line"> decodeBase64 := BASE64StdDecode(encodeBase64)</span><br><span class="line"> fmt.Println(encodeBase64)</span><br><span class="line"> fmt.Println(decodeBase64)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div><p>结果</p><blockquote><p>aHlicGp4<br>hybpjx</p></blockquote><h1 id="AES-加密"><a href="#AES-加密" class="headerlink" title="AES 加密"></a>AES 加密</h1><p>高级加密标准（英语：Advanced Encryption Standard，缩写：AES），在密码学中又称Rijndael加密法，是美国联邦政府采用的一种区块加密标准。这个标准用来替代原先的DES，已经被多方分析且广为全世界所使用。经过五年的甄选流程，高级加密标准由美国国家标准与技术研究院（NIST）于2001年11月26日发布于FIPS PUB 197，并在2002年5月26日成为有效的标准。2006年，高级加密标准已然成为对称密钥加密中最流行的算法之一。<br><img src="https://cdn.nlark.com/yuque/0/2022/png/12843286/1662199524599-a6b77cb9-25c9-4f5b-99c2-493ab50bb7ec.png#clientId=uae04fe37-f91f-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=ub1ee8990&margin=%5Bobject%20Object%5D&name=image.png&originHeight=3573&originWidth=1993&originalType=url&ratio=1&rotation=0&showTitle=false&size=1304823&status=done&style=none&taskId=u8b08ff15-15f1-45c8-b63a-6e18c32ee86&title=" alt="image.png"><br><strong>由于加密和解密的秘钥是相同的，所以AES为对称加密</strong></p><div class="highlight-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"> <span class="string">&quot;bytes&quot;</span></span><br><span class="line"> <span class="string">&quot;crypto/aes&quot;</span></span><br><span class="line"> <span class="string">&quot;crypto/cipher&quot;</span></span><br><span class="line"> <span class="string">&quot;encoding/base64&quot;</span></span><br><span class="line"> <span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">PKCS7Padding</span><span class="params">(ciphertext []<span class="type">byte</span>, blockSize <span class="type">int</span>)</span></span> []<span class="type">byte</span> &#123;</span><br><span class="line"> padding := blockSize - <span class="built_in">len</span>(ciphertext)%blockSize</span><br><span class="line"> padtext := bytes.Repeat([]<span class="type">byte</span>&#123;<span class="type">byte</span>(padding)&#125;, padding)</span><br><span class="line"> <span class="keyword">return</span> <span class="built_in">append</span>(ciphertext, padtext...)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">PKCS7UnPadding</span><span class="params">(origData []<span class="type">byte</span>)</span></span> []<span class="type">byte</span> &#123;</span><br><span class="line"> length := <span class="built_in">len</span>(origData)</span><br><span class="line"> unpadding := <span class="type">int</span>(origData[length<span class="number">-1</span>])</span><br><span class="line"> <span class="keyword">return</span> origData[:(length - unpadding)]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//AES加密</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">AesEncrypt</span><span class="params">(origData, key []<span class="type">byte</span>)</span></span> ([]<span class="type">byte</span>, <span class="type">error</span>) &#123;</span><br><span class="line"> block, err := aes.NewCipher(key)</span><br><span class="line"> <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">nil</span>, err</span><br><span class="line"> &#125;</span><br><span class="line"> blockSize := block.BlockSize()</span><br><span class="line"> origData = PKCS7Padding(origData, blockSize)</span><br><span class="line"> blockMode := cipher.NewCBCEncrypter(block, key[:blockSize])</span><br><span class="line"> crypted := <span class="built_in">make</span>([]<span class="type">byte</span>, <span class="built_in">len</span>(origData))</span><br><span class="line"> blockMode.CryptBlocks(crypted, origData)</span><br><span class="line"> <span class="keyword">return</span> crypted, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//AES解密</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">AesDecrypt</span><span class="params">(crypted, key []<span class="type">byte</span>)</span></span> ([]<span class="type">byte</span>, <span class="type">error</span>) &#123;</span><br><span class="line"> block, err := aes.NewCipher(key)</span><br><span class="line"> <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">nil</span>, err</span><br><span class="line"> &#125;</span><br><span class="line"> blockSize := block.BlockSize()</span><br><span class="line"> blockMode := cipher.NewCBCDecrypter(block, key[:blockSize])</span><br><span class="line"> origData := <span class="built_in">make</span>([]<span class="type">byte</span>, <span class="built_in">len</span>(crypted))</span><br><span class="line"> blockMode.CryptBlocks(origData, crypted)</span><br><span class="line"> origData = PKCS7UnPadding(origData)</span><br><span class="line"> <span class="keyword">return</span> origData, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"> text := <span class="string">&quot;今晚打老虎&quot;</span></span><br><span class="line"> AesKey := []<span class="type">byte</span>(<span class="string">&quot;0f90023fc9ae101e&quot;</span>) <span class="comment">//秘钥长度为16的倍数</span></span><br><span class="line"> fmt.Printf(<span class="string">&quot;明文: %s\n秘钥: %s\n&quot;</span>, text, <span class="type">string</span>(AesKey))</span><br><span class="line"> encrypted, err := AesEncrypt([]<span class="type">byte</span>(text), AesKey)</span><br><span class="line"> <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">  <span class="built_in">panic</span>(err)</span><br><span class="line"> &#125;</span><br><span class="line"> fmt.Printf(<span class="string">&quot;加密后: %s\n&quot;</span>, base64.StdEncoding.EncodeToString(encrypted))</span><br><span class="line"> origin, err := AesDecrypt(encrypted, AesKey)</span><br><span class="line"> <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">  <span class="built_in">panic</span>(err)</span><br><span class="line"> &#125;</span><br><span class="line"> fmt.Printf(<span class="string">&quot;解密后明文: %s\n&quot;</span>, <span class="type">string</span>(origin))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></div><h2 id="CBC方式"><a href="#CBC方式" class="headerlink" title="CBC方式"></a>CBC方式</h2><div class="highlight-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"> <span class="string">&quot;bytes&quot;</span></span><br><span class="line"> <span class="string">&quot;crypto/aes&quot;</span></span><br><span class="line"> <span class="string">&quot;crypto/cipher&quot;</span></span><br><span class="line"> <span class="string">&quot;encoding/base64&quot;</span></span><br><span class="line"> <span class="string">&quot;encoding/hex&quot;</span></span><br><span class="line"> <span class="string">&quot;log&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">AesEncryptCBC</span><span class="params">(origData []<span class="type">byte</span>, key []<span class="type">byte</span>)</span></span> (encrypted []<span class="type">byte</span>) &#123;</span><br><span class="line"> <span class="comment">// 分组秘钥</span></span><br><span class="line"> <span class="comment">// NewCipher该函数限制了输入k的长度必须为16, 24或者32</span></span><br><span class="line"> block, _ := aes.NewCipher(key)</span><br><span class="line"> blockSize := block.BlockSize()                              <span class="comment">// 获取秘钥块的长度</span></span><br><span class="line"> origData = pkcs5Padding(origData, blockSize)                <span class="comment">// 补全码</span></span><br><span class="line"> blockMode := cipher.NewCBCEncrypter(block, key[:blockSize]) <span class="comment">// 加密模式</span></span><br><span class="line"> encrypted = <span class="built_in">make</span>([]<span class="type">byte</span>, <span class="built_in">len</span>(origData))                     <span class="comment">// 创建数组</span></span><br><span class="line"> blockMode.CryptBlocks(encrypted, origData)                  <span class="comment">// 加密</span></span><br><span class="line"> <span class="keyword">return</span> encrypted</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">AesDecryptCBC</span><span class="params">(encrypted []<span class="type">byte</span>, key []<span class="type">byte</span>)</span></span> (decrypted []<span class="type">byte</span>) &#123;</span><br><span class="line"> block, _ := aes.NewCipher(key)                              <span class="comment">// 分组秘钥</span></span><br><span class="line"> blockSize := block.BlockSize()                              <span class="comment">// 获取秘钥块的长度</span></span><br><span class="line"> blockMode := cipher.NewCBCDecrypter(block, key[:blockSize]) <span class="comment">// 加密模式</span></span><br><span class="line"> decrypted = <span class="built_in">make</span>([]<span class="type">byte</span>, <span class="built_in">len</span>(encrypted))                    <span class="comment">// 创建数组</span></span><br><span class="line"> blockMode.CryptBlocks(decrypted, encrypted)                 <span class="comment">// 解密</span></span><br><span class="line"> decrypted = pkcs5UnPadding(decrypted)                       <span class="comment">// 去除补全码</span></span><br><span class="line"> <span class="keyword">return</span> decrypted</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">pkcs5Padding</span><span class="params">(ciphertext []<span class="type">byte</span>, blockSize <span class="type">int</span>)</span></span> []<span class="type">byte</span> &#123;</span><br><span class="line"> padding := blockSize - <span class="built_in">len</span>(ciphertext)%blockSize</span><br><span class="line"> padtext := bytes.Repeat([]<span class="type">byte</span>&#123;<span class="type">byte</span>(padding)&#125;, padding)</span><br><span class="line"> <span class="keyword">return</span> <span class="built_in">append</span>(ciphertext, padtext...)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">pkcs5UnPadding</span><span class="params">(origData []<span class="type">byte</span>)</span></span> []<span class="type">byte</span> &#123;</span><br><span class="line"> length := <span class="built_in">len</span>(origData)</span><br><span class="line"> unpadding := <span class="type">int</span>(origData[length<span class="number">-1</span>])</span><br><span class="line"> <span class="keyword">return</span> origData[:(length - unpadding)]</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"> origData := []<span class="type">byte</span>(<span class="string">&quot;460154561234&quot;</span>) <span class="comment">// 待加密的数据</span></span><br><span class="line"> key := []<span class="type">byte</span>(<span class="string">&quot;9876787656785679&quot;</span>)  <span class="comment">// 加密的密钥</span></span><br><span class="line"> log.Println(<span class="string">&quot;原文：&quot;</span>, <span class="type">string</span>(origData))</span><br><span class="line"></span><br><span class="line"> log.Println(<span class="string">&quot;------------------ CBC模式 --------------------&quot;</span>)</span><br><span class="line"> encrypted := AesEncryptCBC(origData, key)</span><br><span class="line"> log.Println(<span class="string">&quot;密文(hex)：&quot;</span>, hex.EncodeToString(encrypted))</span><br><span class="line"> log.Println(<span class="string">&quot;密文(base64)：&quot;</span>, base64.StdEncoding.EncodeToString(encrypted))</span><br><span class="line"> decrypted := AesDecryptCBC(encrypted, key)</span><br><span class="line"> log.Println(<span class="string">&quot;解密结果：&quot;</span>, <span class="type">string</span>(decrypted))</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div><h2 id="ECB方式"><a href="#ECB方式" class="headerlink" title="ECB方式"></a>ECB方式</h2><div class="highlight-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"> <span class="string">&quot;crypto/aes&quot;</span></span><br><span class="line"> <span class="string">&quot;encoding/base64&quot;</span></span><br><span class="line"> <span class="string">&quot;encoding/hex&quot;</span></span><br><span class="line"> <span class="string">&quot;log&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">AesEncryptECB</span><span class="params">(origData []<span class="type">byte</span>, key []<span class="type">byte</span>)</span></span> (encrypted []<span class="type">byte</span>) &#123;</span><br><span class="line"> cipher, _ := aes.NewCipher(generateKey(key))</span><br><span class="line"> length := (<span class="built_in">len</span>(origData) + aes.BlockSize) / aes.BlockSize</span><br><span class="line"> plain := <span class="built_in">make</span>([]<span class="type">byte</span>, length*aes.BlockSize)</span><br><span class="line"> <span class="built_in">copy</span>(plain, origData)</span><br><span class="line"> pad := <span class="type">byte</span>(<span class="built_in">len</span>(plain) - <span class="built_in">len</span>(origData))</span><br><span class="line"> <span class="keyword">for</span> i := <span class="built_in">len</span>(origData); i &lt; <span class="built_in">len</span>(plain); i++ &#123;</span><br><span class="line">  plain[i] = pad</span><br><span class="line"> &#125;</span><br><span class="line"> encrypted = <span class="built_in">make</span>([]<span class="type">byte</span>, <span class="built_in">len</span>(plain))</span><br><span class="line"> <span class="comment">// 分组分块加密</span></span><br><span class="line"> <span class="keyword">for</span> bs, be := <span class="number">0</span>, cipher.BlockSize(); bs &lt;= <span class="built_in">len</span>(origData); bs, be = bs+cipher.BlockSize(), be+cipher.BlockSize() &#123;</span><br><span class="line">  cipher.Encrypt(encrypted[bs:be], plain[bs:be])</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">return</span> encrypted</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">AesDecryptECB</span><span class="params">(encrypted []<span class="type">byte</span>, key []<span class="type">byte</span>)</span></span> (decrypted []<span class="type">byte</span>) &#123;</span><br><span class="line"> cipher, _ := aes.NewCipher(generateKey(key))</span><br><span class="line"> decrypted = <span class="built_in">make</span>([]<span class="type">byte</span>, <span class="built_in">len</span>(encrypted))</span><br><span class="line"> <span class="comment">//</span></span><br><span class="line"> <span class="keyword">for</span> bs, be := <span class="number">0</span>, cipher.BlockSize(); bs &lt; <span class="built_in">len</span>(encrypted); bs, be = bs+cipher.BlockSize(), be+cipher.BlockSize() &#123;</span><br><span class="line">  cipher.Decrypt(decrypted[bs:be], encrypted[bs:be])</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> trim := <span class="number">0</span></span><br><span class="line"> <span class="keyword">if</span> <span class="built_in">len</span>(decrypted) &gt; <span class="number">0</span> &#123;</span><br><span class="line">  trim = <span class="built_in">len</span>(decrypted) - <span class="type">int</span>(decrypted[<span class="built_in">len</span>(decrypted)<span class="number">-1</span>])</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">return</span> decrypted[:trim]</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">generateKey</span><span class="params">(key []<span class="type">byte</span>)</span></span> (genKey []<span class="type">byte</span>) &#123;</span><br><span class="line"> genKey = <span class="built_in">make</span>([]<span class="type">byte</span>, <span class="number">16</span>)</span><br><span class="line"> <span class="built_in">copy</span>(genKey, key)</span><br><span class="line"> <span class="keyword">for</span> i := <span class="number">16</span>; i &lt; <span class="built_in">len</span>(key); &#123;</span><br><span class="line">  <span class="keyword">for</span> j := <span class="number">0</span>; j &lt; <span class="number">16</span> &amp;&amp; i &lt; <span class="built_in">len</span>(key); j, i = j+<span class="number">1</span>, i+<span class="number">1</span> &#123;</span><br><span class="line">   genKey[j] ^= key[i]</span><br><span class="line">  &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">return</span> genKey</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"> origData := []<span class="type">byte</span>(<span class="string">&quot;460154561234&quot;</span>) <span class="comment">// 待加密的数据</span></span><br><span class="line"> key := []<span class="type">byte</span>(<span class="string">&quot;9876787656785679&quot;</span>)  <span class="comment">// 加密的密钥</span></span><br><span class="line"> log.Println(<span class="string">&quot;原文：&quot;</span>, <span class="type">string</span>(origData))</span><br><span class="line"></span><br><span class="line"> log.Println(<span class="string">&quot;------------------ ECB模式 --------------------&quot;</span>)</span><br><span class="line"> encrypted := AesEncryptECB(origData, key)</span><br><span class="line"> log.Println(<span class="string">&quot;密文(hex)：&quot;</span>, hex.EncodeToString(encrypted))</span><br><span class="line"> log.Println(<span class="string">&quot;密文(base64)：&quot;</span>, base64.StdEncoding.EncodeToString(encrypted))</span><br><span class="line"> decrypted := AesDecryptECB(encrypted, key)</span><br><span class="line"> log.Println(<span class="string">&quot;解密结果：&quot;</span>, <span class="type">string</span>(decrypted))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h2 id="CFB-方式"><a href="#CFB-方式" class="headerlink" title="CFB 方式"></a>CFB 方式</h2><div class="highlight-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"> <span class="string">&quot;crypto/aes&quot;</span></span><br><span class="line"> <span class="string">&quot;crypto/cipher&quot;</span></span><br><span class="line"> <span class="string">&quot;crypto/rand&quot;</span></span><br><span class="line"> <span class="string">&quot;encoding/base64&quot;</span></span><br><span class="line"> <span class="string">&quot;encoding/hex&quot;</span></span><br><span class="line"> <span class="string">&quot;io&quot;</span></span><br><span class="line"> <span class="string">&quot;log&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">AesEncryptCFB</span><span class="params">(origData []<span class="type">byte</span>, key []<span class="type">byte</span>)</span></span> (encrypted []<span class="type">byte</span>) &#123;</span><br><span class="line"> block, err := aes.NewCipher(key)</span><br><span class="line"> <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">  <span class="built_in">panic</span>(err)</span><br><span class="line"> &#125;</span><br><span class="line"> encrypted = <span class="built_in">make</span>([]<span class="type">byte</span>, aes.BlockSize+<span class="built_in">len</span>(origData))</span><br><span class="line"> iv := encrypted[:aes.BlockSize]</span><br><span class="line"> <span class="keyword">if</span> _, err := io.ReadFull(rand.Reader, iv); err != <span class="literal">nil</span> &#123;</span><br><span class="line">  <span class="built_in">panic</span>(err)</span><br><span class="line"> &#125;</span><br><span class="line"> stream := cipher.NewCFBEncrypter(block, iv)</span><br><span class="line"> stream.XORKeyStream(encrypted[aes.BlockSize:], origData)</span><br><span class="line"> <span class="keyword">return</span> encrypted</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">AesDecryptCFB</span><span class="params">(encrypted []<span class="type">byte</span>, key []<span class="type">byte</span>)</span></span> (decrypted []<span class="type">byte</span>) &#123;</span><br><span class="line"> block, _ := aes.NewCipher(key)</span><br><span class="line"> <span class="keyword">if</span> <span class="built_in">len</span>(encrypted) &lt; aes.BlockSize &#123;</span><br><span class="line">  <span class="built_in">panic</span>(<span class="string">&quot;ciphertext too short&quot;</span>)</span><br><span class="line"> &#125;</span><br><span class="line"> iv := encrypted[:aes.BlockSize]</span><br><span class="line"> encrypted = encrypted[aes.BlockSize:]</span><br><span class="line"></span><br><span class="line"> stream := cipher.NewCFBDecrypter(block, iv)</span><br><span class="line"> stream.XORKeyStream(encrypted, encrypted)</span><br><span class="line"> <span class="keyword">return</span> encrypted</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"> origData := []<span class="type">byte</span>(<span class="string">&quot;460154561234&quot;</span>) <span class="comment">// 待加密的数据</span></span><br><span class="line"> key := []<span class="type">byte</span>(<span class="string">&quot;9876787656785679&quot;</span>)  <span class="comment">// 加密的密钥</span></span><br><span class="line"> log.Println(<span class="string">&quot;原文：&quot;</span>, <span class="type">string</span>(origData))</span><br><span class="line"></span><br><span class="line"> log.Println(<span class="string">&quot;------------------ CFB模式 --------------------&quot;</span>)</span><br><span class="line"> encrypted := AesEncryptCFB(origData, key)</span><br><span class="line"> log.Println(<span class="string">&quot;密文(hex)：&quot;</span>, hex.EncodeToString(encrypted))</span><br><span class="line"> log.Println(<span class="string">&quot;密文(base64)：&quot;</span>, base64.StdEncoding.EncodeToString(encrypted))</span><br><span class="line"> decrypted := AesDecryptCFB(encrypted, key)</span><br><span class="line"> log.Println(<span class="string">&quot;解密结果：&quot;</span>, <span class="type">string</span>(decrypted))</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div><h1 id="RSA加密"><a href="#RSA加密" class="headerlink" title="RSA加密"></a>RSA加密</h1><p>RSA是一种基于公钥密码体制的优秀加密算法，1978年由美国(MIT)的李维斯特(Rivest)、沙米尔(Shamir)、艾德曼(Adleman)提的。<br>RSA算法是一种分组密码体制算法，它的保密强度是建立在具有大素数因子的合数其因子分解是困难的（基于大数分解的难度）。<br>公钥和私钥是一对大素数的函数，从一个公钥和密文中恢复出明文的难度等价于分解两个大素数之积。<br>RSA得到了世界上的最广泛的应用，ISO在1992年颁布的国际标准X.509中,将RSA算法正式纳入国际标准。</p><h2 id="RSA加密-1"><a href="#RSA加密-1" class="headerlink" title="RSA加密"></a>RSA加密</h2><div class="highlight-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"> <span class="string">&quot;crypto/rand&quot;</span></span><br><span class="line"> <span class="string">&quot;crypto/rsa&quot;</span></span><br><span class="line"> <span class="string">&quot;crypto/x509&quot;</span></span><br><span class="line"> <span class="string">&quot;encoding/pem&quot;</span></span><br><span class="line"> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"> <span class="string">&quot;os&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// GenerateRSAKey 生成RSA私钥和公钥，保存到文件中</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GenerateRSAKey</span><span class="params">(bits <span class="type">int</span>)</span></span>&#123;</span><br><span class="line"> <span class="comment">//GenerateKey函数使用随机数据生成器random生成一对具有指定字位数的RSA密钥</span></span><br><span class="line"> <span class="comment">//Reader是一个全局、共享的密码用强随机数生成器</span></span><br><span class="line"> privateKey, err := rsa.GenerateKey(rand.Reader, bits)</span><br><span class="line"> <span class="keyword">if</span> err!=<span class="literal">nil</span>&#123;</span><br><span class="line">  <span class="built_in">panic</span>(err)</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="comment">//保存私钥</span></span><br><span class="line"> <span class="comment">//通过x509标准将得到的ras私钥序列化为ASN.1 的 DER编码字符串</span></span><br><span class="line"> <span class="comment">// X509PrivateKey := x509.MarshalPKCS1PrivateKey(privateKey) // PKCS1 和 9 是不一致的</span></span><br><span class="line"> X509PrivateKey,err := x509.MarshalPKCS8PrivateKey(privateKey)</span><br><span class="line"> <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">  fmt.Println(err.Error())</span><br><span class="line">  os.Exit(<span class="number">0</span>)</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="comment">//使用pem格式对x509输出的内容进行编码</span></span><br><span class="line"> <span class="comment">//创建文件保存私钥</span></span><br><span class="line"> privateFile, err := os.Create(<span class="string">&quot;private.pem&quot;</span>)</span><br><span class="line"> <span class="keyword">if</span> err!=<span class="literal">nil</span>&#123;</span><br><span class="line">  <span class="built_in">panic</span>(err)</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">defer</span> privateFile.Close()</span><br><span class="line"> <span class="comment">//构建一个pem.Block结构体对象</span></span><br><span class="line"> privateBlock:= pem.Block&#123;Type: <span class="string">&quot;PRIVATE KEY&quot;</span>,Bytes:X509PrivateKey&#125;</span><br><span class="line"> <span class="comment">//将数据保存到文件</span></span><br><span class="line"> pem.Encode(privateFile,&amp;privateBlock)</span><br><span class="line"> <span class="comment">//保存公钥</span></span><br><span class="line"> <span class="comment">//获取公钥的数据</span></span><br><span class="line"> publicKey:=privateKey.PublicKey</span><br><span class="line"> <span class="comment">//X509对公钥编码</span></span><br><span class="line"> X509PublicKey,err:=x509.MarshalPKIXPublicKey(&amp;publicKey)</span><br><span class="line"> <span class="keyword">if</span> err!=<span class="literal">nil</span>&#123;</span><br><span class="line">  <span class="built_in">panic</span>(err)</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="comment">//pem格式编码</span></span><br><span class="line"> <span class="comment">//创建用于保存公钥的文件</span></span><br><span class="line"> publicFile, err := os.Create(<span class="string">&quot;public.pem&quot;</span>)</span><br><span class="line"> <span class="keyword">if</span> err!=<span class="literal">nil</span>&#123;</span><br><span class="line">  <span class="built_in">panic</span>(err)</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">defer</span> publicFile.Close()</span><br><span class="line"> <span class="comment">//创建一个pem.Block结构体对象</span></span><br><span class="line"> publicBlock:= pem.Block&#123;Type: <span class="string">&quot;Public Key&quot;</span>,Bytes:X509PublicKey&#125;</span><br><span class="line"> <span class="comment">//保存到文件</span></span><br><span class="line"> pem.Encode(publicFile,&amp;publicBlock)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// RsaEncrypt RSA加密</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">RsaEncrypt</span><span class="params">(plainText []<span class="type">byte</span>,path <span class="type">string</span>)</span></span>[]<span class="type">byte</span>&#123;</span><br><span class="line"> <span class="comment">//打开文件</span></span><br><span class="line"> file,err:=os.Open(path)</span><br><span class="line"> <span class="keyword">if</span> err!=<span class="literal">nil</span>&#123;</span><br><span class="line">  <span class="built_in">panic</span>(err)</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">defer</span> file.Close()</span><br><span class="line"> <span class="comment">//读取文件的内容</span></span><br><span class="line"> info, _ := file.Stat()</span><br><span class="line"> buf:=<span class="built_in">make</span>([]<span class="type">byte</span>,info.Size())</span><br><span class="line"> file.Read(buf)</span><br><span class="line"> <span class="comment">//pem解码</span></span><br><span class="line"> block, _ := pem.Decode(buf)</span><br><span class="line"> <span class="comment">//x509解码</span></span><br><span class="line"> publicKeyInterface, err := x509.ParsePKIXPublicKey(block.Bytes)</span><br><span class="line"> <span class="keyword">if</span> err!=<span class="literal">nil</span>&#123;</span><br><span class="line">  <span class="built_in">panic</span>(err)</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="comment">//类型断言</span></span><br><span class="line"> publicKey:=publicKeyInterface.(*rsa.PublicKey)</span><br><span class="line"> <span class="comment">//对明文进行加密</span></span><br><span class="line"> cipherText, err := rsa.EncryptPKCS1v15(rand.Reader, publicKey, plainText)</span><br><span class="line"> <span class="keyword">if</span> err!=<span class="literal">nil</span>&#123;</span><br><span class="line">  <span class="built_in">panic</span>(err)</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="comment">//返回密文</span></span><br><span class="line"> <span class="keyword">return</span> cipherText</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// RsaDecrypt RSA解密</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">RsaDecrypt</span><span class="params">(cipherText []<span class="type">byte</span>,path <span class="type">string</span>)</span></span> []<span class="type">byte</span>&#123;</span><br><span class="line"> <span class="comment">//打开文件</span></span><br><span class="line"> file,err:=os.Open(path)</span><br><span class="line"> <span class="keyword">if</span> err!=<span class="literal">nil</span>&#123;</span><br><span class="line">  <span class="built_in">panic</span>(err)</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">defer</span> file.Close()</span><br><span class="line"> <span class="comment">//获取文件内容</span></span><br><span class="line"> info, _ := file.Stat()</span><br><span class="line"> buf:=<span class="built_in">make</span>([]<span class="type">byte</span>,info.Size())</span><br><span class="line"> file.Read(buf)</span><br><span class="line"> <span class="comment">//pem解码</span></span><br><span class="line"> block, _ := pem.Decode(buf)</span><br><span class="line"> <span class="comment">//X509解码</span></span><br><span class="line"> privateKey, err := x509.ParsePKCS8PrivateKey(block.Bytes)</span><br><span class="line"> <span class="keyword">if</span> err!=<span class="literal">nil</span>&#123;</span><br><span class="line">  fmt.Println(err.Error())</span><br><span class="line">  os.Exit(<span class="number">0</span>)</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="comment">//对密文进行解密</span></span><br><span class="line"> plainText,_:=rsa.DecryptPKCS1v15(rand.Reader,privateKey.(*rsa.PrivateKey),cipherText)</span><br><span class="line"> <span class="comment">//返回明文</span></span><br><span class="line"> <span class="keyword">return</span> plainText</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"> <span class="comment">// RSA/ECB/PKCS1Padding</span></span><br><span class="line"> <span class="comment">// RSA是算法，ECB是分块模式，PKCS1Padding是填充模式</span></span><br><span class="line"></span><br><span class="line"> <span class="comment">// pkcs1私钥生成openssl genrsa -out pkcs1.pem 1024</span></span><br><span class="line"> <span class="comment">// pkcs1转pkcs8私钥 ：openssl pkcs8 -in pkcs8.pem -nocrypt -out pkcs1.pem</span></span><br><span class="line"></span><br><span class="line"> <span class="comment">// pkcs1 BEGIN RSA PRIVATE KEY</span></span><br><span class="line"> <span class="comment">// pkcs8 BEGIN PRIVATE KEY</span></span><br><span class="line"></span><br><span class="line"> GenerateRSAKey(<span class="number">1024</span>)</span><br><span class="line"> publicPath := <span class="string">&quot;public_key.pem&quot;</span></span><br><span class="line"> privatePath := <span class="string">&quot;private_key.pem&quot;</span></span><br><span class="line"></span><br><span class="line"> publicPath = <span class="string">&quot;public.pem&quot;</span></span><br><span class="line"> privatePath = <span class="string">&quot;private.pem&quot;</span></span><br><span class="line"></span><br><span class="line"> txt := []<span class="type">byte</span>(<span class="string">&quot;hello&quot;</span>)</span><br><span class="line"> encrptTxt := RsaEncrypt(txt,publicPath)</span><br><span class="line"> decrptCode := RsaDecrypt(encrptTxt,privatePath)</span><br><span class="line"> fmt.Println(<span class="type">string</span>(decrptCode))</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div><h2 id="RSA分段加密"><a href="#RSA分段加密" class="headerlink" title="RSA分段加密"></a>RSA分段加密</h2><div class="highlight-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"> <span class="string">&quot;bytes&quot;</span></span><br><span class="line"> <span class="string">&quot;crypto/rand&quot;</span></span><br><span class="line"> <span class="string">&quot;crypto/rsa&quot;</span></span><br><span class="line"> <span class="string">&quot;crypto/x509&quot;</span></span><br><span class="line"> <span class="string">&quot;encoding/base64&quot;</span></span><br><span class="line"> <span class="string">&quot;encoding/pem&quot;</span></span><br><span class="line"> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"> <span class="string">&quot;log&quot;</span></span><br><span class="line"> <span class="string">&quot;os&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"> GenerateRSAKey(<span class="number">2048</span>)</span><br><span class="line"> publicPath := <span class="string">&quot;public.pem&quot;</span></span><br><span class="line"> privatePath := <span class="string">&quot;private.pem&quot;</span></span><br><span class="line"> <span class="keyword">var</span> a = []<span class="type">byte</span>(<span class="string">&quot;hello&quot;</span>)</span><br><span class="line"> encrptTxt, err := RsaEncryptBlock(a, publicPath)</span><br><span class="line"> <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">  fmt.Println(err.Error())</span><br><span class="line"> &#125;</span><br><span class="line"> encodeString := base64.StdEncoding.EncodeToString(encrptTxt)</span><br><span class="line"> decodeByte, err := base64.StdEncoding.DecodeString(encodeString)</span><br><span class="line"> <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">  <span class="built_in">panic</span>(err)</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="comment">//生成RSA私钥和公钥，保存到文件中</span></span><br><span class="line"> decrptCode := RSA_Decrypts(decodeByte, privatePath)</span><br><span class="line"> fmt.Println(<span class="type">string</span>(decrptCode))</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GenerateRSAKey</span><span class="params">(bits <span class="type">int</span>)</span></span> &#123;</span><br><span class="line"> <span class="comment">//GenerateKey函数使用随机数据生成器random生成一对具有指定字位数的RSA密钥</span></span><br><span class="line"> <span class="comment">//Reader是一个全局、共享的密码用强随机数生成器</span></span><br><span class="line"> privateKey, err := rsa.GenerateKey(rand.Reader, bits)</span><br><span class="line"> <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">  <span class="built_in">panic</span>(err)</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="comment">//保存私钥</span></span><br><span class="line"> <span class="comment">//通过x509标准将得到的ras私钥序列化为ASN.1 的 DER编码字符串</span></span><br><span class="line"> <span class="comment">// X509PrivateKey := x509.MarshalPKCS1PrivateKey(privateKey) // PKCS1 和 9 是不一致的</span></span><br><span class="line"> X509PrivateKey, err := x509.MarshalPKCS8PrivateKey(privateKey)</span><br><span class="line"> <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">  fmt.Println(err.Error())</span><br><span class="line">  os.Exit(<span class="number">0</span>)</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="comment">//使用pem格式对x509输出的内容进行编码</span></span><br><span class="line"> <span class="comment">//创建文件保存私钥</span></span><br><span class="line"> privateFile, err := os.Create(<span class="string">&quot;private.pem&quot;</span>)</span><br><span class="line"> <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">  <span class="built_in">panic</span>(err)</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">defer</span> privateFile.Close()</span><br><span class="line"> <span class="comment">//构建一个pem.Block结构体对象</span></span><br><span class="line"> privateBlock := pem.Block&#123;Type: <span class="string">&quot;PRIVATE KEY&quot;</span>, Bytes: X509PrivateKey&#125;</span><br><span class="line"> <span class="comment">//将数据保存到文件</span></span><br><span class="line"> pem.Encode(privateFile, &amp;privateBlock)</span><br><span class="line"> <span class="comment">//保存公钥</span></span><br><span class="line"> <span class="comment">//获取公钥的数据</span></span><br><span class="line"> publicKey := privateKey.PublicKey</span><br><span class="line"> <span class="comment">//X509对公钥编码</span></span><br><span class="line"> X509PublicKey, err := x509.MarshalPKIXPublicKey(&amp;publicKey)</span><br><span class="line"> <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">  <span class="built_in">panic</span>(err)</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="comment">//pem格式编码</span></span><br><span class="line"> <span class="comment">//创建用于保存公钥的文件</span></span><br><span class="line"> publicFile, err := os.Create(<span class="string">&quot;public.pem&quot;</span>)</span><br><span class="line"> <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">  <span class="built_in">panic</span>(err)</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">defer</span> publicFile.Close()</span><br><span class="line"> <span class="comment">//创建一个pem.Block结构体对象</span></span><br><span class="line"> publicBlock := pem.Block&#123;Type: <span class="string">&quot;Public Key&quot;</span>, Bytes: X509PublicKey&#125;</span><br><span class="line"> <span class="comment">//保存到文件</span></span><br><span class="line"> pem.Encode(publicFile, &amp;publicBlock)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// RSA_Decrypts RSA解密支持分段解密</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">RSA_Decrypts</span><span class="params">(cipherText []<span class="type">byte</span>, path <span class="type">string</span>)</span></span> []<span class="type">byte</span> &#123;</span><br><span class="line"> <span class="comment">//打开文件</span></span><br><span class="line"> <span class="keyword">var</span> bytesDecrypt []<span class="type">byte</span></span><br><span class="line"> file, err := os.Open(path)</span><br><span class="line"> <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">  <span class="built_in">panic</span>(err)</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">defer</span> file.Close()</span><br><span class="line"> <span class="comment">//获取文件内容</span></span><br><span class="line"> info, _ := file.Stat()</span><br><span class="line"> buf := <span class="built_in">make</span>([]<span class="type">byte</span>, info.Size())</span><br><span class="line"> file.Read(buf)</span><br><span class="line"> <span class="comment">//pem解码</span></span><br><span class="line"> block, _ := pem.Decode(buf)</span><br><span class="line"> <span class="comment">//X509解码</span></span><br><span class="line"> privateKey, err := x509.ParsePKCS8PrivateKey(block.Bytes)</span><br><span class="line"> <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">  fmt.Println(err.Error())</span><br><span class="line">  os.Exit(<span class="number">0</span>)</span><br><span class="line"> &#125;</span><br><span class="line"> p := privateKey.(*rsa.PrivateKey)</span><br><span class="line"> keySize := p.Size()</span><br><span class="line"> srcSize := <span class="built_in">len</span>(cipherText)</span><br><span class="line"> log.Println(<span class="string">&quot;密钥长度&quot;</span>, keySize, <span class="string">&quot;密文长度&quot;</span>, srcSize)</span><br><span class="line"> <span class="keyword">var</span> offSet = <span class="number">0</span></span><br><span class="line"> <span class="keyword">var</span> buffer = bytes.Buffer&#123;&#125;</span><br><span class="line"> <span class="keyword">for</span> offSet &lt; srcSize &#123;</span><br><span class="line">  endIndex := offSet + keySize</span><br><span class="line">  <span class="keyword">if</span> endIndex &gt; srcSize &#123;</span><br><span class="line">   endIndex = srcSize</span><br><span class="line">  &#125;</span><br><span class="line">  bytesOnce, err := rsa.DecryptPKCS1v15(rand.Reader, p, cipherText[offSet:endIndex])</span><br><span class="line">  <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">   <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">  &#125;</span><br><span class="line">  buffer.Write(bytesOnce)</span><br><span class="line">  offSet = endIndex</span><br><span class="line"> &#125;</span><br><span class="line"> bytesDecrypt = buffer.Bytes()</span><br><span class="line"> <span class="keyword">return</span> bytesDecrypt</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// RsaEncryptBlock 公钥加密-分段</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">RsaEncryptBlock</span><span class="params">(src []<span class="type">byte</span>, path <span class="type">string</span>)</span></span> (bytesEncrypt []<span class="type">byte</span>, err <span class="type">error</span>) &#123;</span><br><span class="line"> <span class="comment">//打开文件</span></span><br><span class="line"> file, err := os.Open(path)</span><br><span class="line"> <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">  <span class="built_in">panic</span>(err)</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">defer</span> file.Close()</span><br><span class="line"> <span class="comment">//读取文件的内容</span></span><br><span class="line"> info, _ := file.Stat()</span><br><span class="line"> buf := <span class="built_in">make</span>([]<span class="type">byte</span>, info.Size())</span><br><span class="line"> file.Read(buf)</span><br><span class="line"> <span class="comment">//pem解码</span></span><br><span class="line"> block, _ := pem.Decode(buf)</span><br><span class="line"> <span class="comment">//x509解码</span></span><br><span class="line"> publicKeyInterface, err := x509.ParsePKIXPublicKey(block.Bytes)</span><br><span class="line"> <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">  <span class="built_in">panic</span>(err)</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="comment">//类型断言</span></span><br><span class="line"> publicKey := publicKeyInterface.(*rsa.PublicKey)</span><br><span class="line"> keySize, srcSize := publicKey.Size(), <span class="built_in">len</span>(src)</span><br><span class="line"> log.Println(<span class="string">&quot;密钥长度&quot;</span>, keySize, <span class="string">&quot;明文长度&quot;</span>, srcSize)</span><br><span class="line"> offSet, once := <span class="number">0</span>, keySize<span class="number">-11</span></span><br><span class="line"> buffer := bytes.Buffer&#123;&#125;</span><br><span class="line"> <span class="keyword">for</span> offSet &lt; srcSize &#123;</span><br><span class="line">  endIndex := offSet + once</span><br><span class="line">  <span class="keyword">if</span> endIndex &gt; srcSize &#123;</span><br><span class="line">   endIndex = srcSize</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 加密一部分</span></span><br><span class="line">  bytesOnce, err := rsa.EncryptPKCS1v15(rand.Reader, publicKey, src[offSet:endIndex])</span><br><span class="line">  <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">   <span class="keyword">return</span> <span class="literal">nil</span>, err</span><br><span class="line">  &#125;</span><br><span class="line">  buffer.Write(bytesOnce)</span><br><span class="line">  offSet = endIndex</span><br><span class="line"> &#125;</span><br><span class="line"> bytesEncrypt = buffer.Bytes()</span><br><span class="line"> <span class="keyword">return</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h1 id="DES加密"><a href="#DES加密" class="headerlink" title="DES加密"></a>DES加密</h1><ul><li>DES(Data Encryption)是1977年美国联邦信息处理标准(FIPS)中所采用的一种对称密码（FIPS46-3）,一直以来被美国及其他国家的政府和银行等广泛使用。随着计算机的进步，DES已经能够被暴力破解,1997年的DES Challenge I 中用了96天破译密钥，1998年的DES Challenge II-1中用了41天，1998年的DES Challenge II-2中用了56小时，1999年的DES Challenge III 中只用了22小时15分钟。</li><li>DES是一种将64比特的明文加密成64比特的密文的对称密码算法，它的密钥的长度是56比特。尽管从规格上来说，DES的密钥长度是64比特，但由于每隔7比特会设置一个用于错误检查的比特，因此实质上其密钥长度是56比特。</li><li>DES 是以64比特的明文（比特序列）为一个单位来进行加密的，这个64比特的单位称为分组 ，一般来说，以分组为单位进行处理的密码算法称为分组密码，DES就是分组密码的一种。</li><li>DES每次只能加密64比特的数据，如果要加密的明文比较长，就需要对DES加密进行迭代（反复），而迭代的具体方式就称为模式。</li><li>DES 内部实现理论：在 des 中各个步骤称为轮，整个加密过程进行16轮循环。</li></ul><h2 id="内置库完成"><a href="#内置库完成" class="headerlink" title="内置库完成"></a>内置库完成</h2><p>加密模式采用ECB、填充方式采用pkcs5padding、密码使用”12345678”,输出时经hex编码。自己可以通过一些在线测试工具进行测试，看结果是否一致。</p><div class="highlight-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"> <span class="string">&quot;bytes&quot;</span></span><br><span class="line"> <span class="string">&quot;crypto/cipher&quot;</span></span><br><span class="line"> <span class="string">&quot;crypto/des&quot;</span></span><br><span class="line"> <span class="string">&quot;encoding/hex&quot;</span></span><br><span class="line"> <span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"> data := []<span class="type">byte</span>(<span class="string">&quot;hello world&quot;</span>)</span><br><span class="line"> key := []<span class="type">byte</span>(<span class="string">&quot;12345678&quot;</span>)</span><br><span class="line"> iv := []<span class="type">byte</span>(<span class="string">&quot;43218765&quot;</span>)</span><br><span class="line"></span><br><span class="line"> result, err := DesCBCEncrypt(data, key, iv)</span><br><span class="line"> <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">  fmt.Println(err)</span><br><span class="line"> &#125;</span><br><span class="line"> b := hex.EncodeToString(result)</span><br><span class="line"> fmt.Println(b)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">DesCBCEncrypt</span><span class="params">(data, key, iv []<span class="type">byte</span>)</span></span> ([]<span class="type">byte</span>, <span class="type">error</span>) &#123;</span><br><span class="line"> block, err := des.NewCipher(key)</span><br><span class="line"> <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">nil</span>, err</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> data = pkcs5Padding(data, block.BlockSize())</span><br><span class="line"> cryptText := <span class="built_in">make</span>([]<span class="type">byte</span>, <span class="built_in">len</span>(data))</span><br><span class="line"></span><br><span class="line"> blockMode := cipher.NewCBCEncrypter(block, iv)</span><br><span class="line"> blockMode.CryptBlocks(cryptText, data)</span><br><span class="line"> <span class="keyword">return</span> cryptText, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">pkcs5Padding</span><span class="params">(cipherText []<span class="type">byte</span>, blockSize <span class="type">int</span>)</span></span> []<span class="type">byte</span> &#123;</span><br><span class="line"> padding := blockSize - <span class="built_in">len</span>(cipherText)%blockSize</span><br><span class="line"> padText := bytes.Repeat([]<span class="type">byte</span>&#123;<span class="type">byte</span>(padding)&#125;, padding)</span><br><span class="line"> <span class="keyword">return</span> <span class="built_in">append</span>(cipherText, padText...)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div><h2 id="使用第三方库"><a href="#使用第三方库" class="headerlink" title="使用第三方库"></a>使用第三方库</h2><div class="highlight-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"> <span class="string">&quot;github.com/marspere/goencrypt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"> <span class="comment">// key为12345678</span></span><br><span class="line"> <span class="comment">// iv为空</span></span><br><span class="line"> <span class="comment">// 采用ECB分组模式</span></span><br><span class="line"> <span class="comment">// 采用pkcs5padding填充模式</span></span><br><span class="line"> <span class="comment">// 输出结果使用base64进行加密</span></span><br><span class="line"> cipher := goencrypt.NewDESCipher([]<span class="type">byte</span>(<span class="string">&quot;12345678&quot;</span>), []<span class="type">byte</span>(<span class="string">&quot;&quot;</span>), goencrypt.ECBMode, goencrypt.Pkcs7, goencrypt.PrintBase64)</span><br><span class="line"> cipherText, err := cipher.DESEncrypt([]<span class="type">byte</span>(<span class="string">&quot;hello world&quot;</span>))</span><br><span class="line"> <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">  fmt.Println(err)</span><br><span class="line">  <span class="keyword">return</span></span><br><span class="line"> &#125;</span><br><span class="line"> fmt.Println(cipherText)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h1 id="3DES加密算法"><a href="#3DES加密算法" class="headerlink" title="3DES加密算法"></a>3DES加密算法</h1><p>3DES（或称为Triple DES）是三重数据加密算法（TDEA，Triple Data Encryption Algorithm）块密码的通称。它相当于是对每个数据块应用三次DES加密算法。<br>由于计算机运算能力的增强，原版DES密码的密钥长度变得容易被暴力破解；3DES即是设计用来提供一种相对简单的方法，即通过增加DES的密钥长度来避免类似的攻击，而不是设计一种全新的块密码算法。<br>还有一个库 非常NB</p><p>ECB模式下的3DES算法加解密信息，golang默认只提供CBC模式<br>这边有golang的加密库，非常厉害<br><strong>github.com&#x2F;forgoer&#x2F;openssl</strong></p><p>安装：<br><strong>go get github.com&#x2F;thinkoner&#x2F;openssl</strong></p><p>代码如下：</p><div class="highlight-container" data-rel="Golang"><figure class="iseeu highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"> <span class="string">&quot;encoding/base64&quot;</span></span><br><span class="line"> <span class="string">&quot;encoding/hex&quot;</span></span><br><span class="line"> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"> <span class="string">&quot;github.com/forgoer/openssl&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line"> <span class="comment">//定义密钥，必须是24byte</span></span><br><span class="line"> key := []<span class="type">byte</span>(<span class="string">&quot;123456789012345678901234&quot;</span>)</span><br><span class="line"> fmt.Println(<span class="string">&quot;密钥：&quot;</span>, key, hex.EncodeToString(key))</span><br><span class="line"></span><br><span class="line"> <span class="comment">//定义明文</span></span><br><span class="line"> src := []<span class="type">byte</span>(<span class="string">&quot;0102030109000000030000000F8898E37A7F8F3D742006111118080000FACE05&quot;</span>)</span><br><span class="line"></span><br><span class="line"> <span class="comment">//3DES-ECB加密</span></span><br><span class="line"> encodeData, _ := openssl.Des3ECBEncrypt(src, key, openssl.ZEROS_PADDING)</span><br><span class="line"> encryptBaseData := base64.StdEncoding.EncodeToString(encodeData)</span><br><span class="line"></span><br><span class="line"> fmt.Println(<span class="string">&quot;加密后Base64：&quot;</span>, encryptBaseData)</span><br><span class="line"> fmt.Println(<span class="string">&quot;加密后Hex：&quot;</span>, hex.EncodeToString(encodeData))</span><br><span class="line"></span><br><span class="line"> <span class="comment">//3DES-ECB解密</span></span><br><span class="line"> decodeBaseData, _ := base64.StdEncoding.DecodeString(encryptBaseData)</span><br><span class="line"> decodeData, _ := openssl.Des3ECBDecrypt(decodeBaseData, key, openssl.ZEROS_PADDING)</span><br><span class="line"></span><br><span class="line"> fmt.Println(<span class="string">&quot;解密后：&quot;</span>, hex.EncodeToString(decodeData))</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div><h2 id="包括-Des的加密解密"><a href="#包括-Des的加密解密" class="headerlink" title="包括 Des的加密解密"></a>包括 Des的加密解密</h2><p>以下只举一个例子</p><div class="highlight-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">srcData := <span class="string">&quot;L0j+JvbeVM0svSpjIwXdE7yTu78wiEszCmW8rwjXY3vrx2nEaUeJ/Rw/c/IRdlxIH+/ro4pykx6ESOkGU1YwM8ddEuuoTg5uPsqQ9/SuNds=&quot;</span></span><br><span class="line">key := []<span class="type">byte</span>(<span class="string">&quot;Ctpsp@884*&quot;</span>[:<span class="number">8</span>])</span><br><span class="line"><span class="comment">//3DES-ECB解密</span></span><br><span class="line">decodeBaseData, _ := base64.StdEncoding.DecodeString(srcData)</span><br><span class="line">decodeData, _ := openssl.DesECBDecrypt(decodeBaseData, key, openssl.PKCS5_PADDING)</span><br><span class="line">fmt.Println(<span class="string">&quot;解密后：&quot;</span>, <span class="type">string</span>(decodeData))</span><br></pre></td></tr></table></figure></div></div><div class="post-copyright-info w-full my-8 px-2 sm:px-6 md:px-8"><div class="article-copyright-info-container"><ul><li><strong>标题:</strong> Golang加密解密算法</li><li><strong>作者:</strong> 流转</li><li><strong>创建于 :</strong> 2022-09-26 17:06:57</li><li><strong>更新于 :</strong> 2024-08-28 16:10:06</li><li><strong>链接:</strong> http://hybpjx.github.io/2022/09/26/Golang加密解密算法/</li><li><strong>版权声明: </strong>本文章采用 <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0">CC BY-NC-SA 4.0</a> 进行许可。</li></ul></div></div><ul class="post-tags-box text-lg mt-1.5 flex-wrap justify-center flex md:hidden"><li class="tag-item mx-0.5"><a href="/tags/Golang/">#Golang</a>&nbsp;</li></ul><div class="article-nav my-8 flex justify-between items-center px-2 sm:px-6 md:px-8"><div class="article-prev border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2"><a class="prev" rel="prev" href="/2022/11/04/Python%E5%8A%A0%E5%AF%86%E8%A7%A3%E5%AF%86%E7%AE%97%E6%B3%95/"><span class="left arrow-icon flex justify-center items-center"><i class="fa-solid fa-chevron-left"></i> </span><span class="title flex justify-center items-center"><span class="post-nav-title-item">Python加密解密算法</span> <span class="post-nav-item">上一篇</span></span></a></div><div class="article-next border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2"><a class="next" rel="next" href="/2022/05/26/%E5%AE%89%E8%A3%85NVM%E4%B8%8E%E6%9E%84%E5%BB%BAvue%E9%A1%B9%E7%9B%AE/"><span class="title flex justify-center items-center"><span class="post-nav-title-item">安装NVM与构建vue项目</span> <span class="post-nav-item">下一篇</span> </span><span class="right arrow-icon flex justify-center items-center"><i class="fa-solid fa-chevron-right"></i></span></a></div></div><div class="comment-container px-2 sm:px-6 md:px-8 pb-8"><div class="comments-container mt-10 w-full"><div id="comment-anchor" class="w-full h-2.5"></div><div class="comment-area-title w-full my-1.5 md:my-2.5 text-xl md:text-3xl font-bold">评论</div><div id="giscus-container"></div><script data-swup-reload-script defer>async function loadGiscus() {
            const giscusConfig = {
                'src': 'https://giscus.app/client.js',
                'data-repo': 'hybpjx/giscus',
                'data-repo-id': 'R_kgDOMo7cQg',
                'data-category': 'Announcements',
                'data-category-id': 'DIC_kwDOMo7cQs4Ch9bl',
                'data-mapping': 'pathname',
                'data-strict': '0',
                'data-reactions-enabled': '1',
                'data-emit-metadata': '1',
                'data-theme': 'preferred_color_scheme',
                'data-lang': 'zh-CN',
                'data-input-position': 'bottom',
                'data-loading': 'lazy',
                'crossorigin': 'anonymous',
                'async': true
            }
            const giscusScript = document.createElement('script');
            for (const key in giscusConfig) {
                giscusScript.setAttribute(key, giscusConfig[key]);
            }
            document.getElementById('giscus-container').appendChild(giscusScript);
        }
        if ('true') {
            let loadGiscusTimeout = setTimeout(() => {
                loadGiscus();
                clearTimeout(loadGiscusTimeout);
            }, 1000);
        } else {
            document.addEventListener('DOMContentLoaded', loadGiscus);
        }</script></div></div></div><div class="toc-content-container"><div class="post-toc-wrap"><div class="post-toc"><div class="toc-title">此页目录</div><div class="page-title">Golang加密解密算法</div><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#md5-%E5%8A%A0%E5%AF%86%E2%80%94%E2%80%94%E4%B8%8D%E5%8F%AF%E9%80%86"><span class="nav-number">1.</span> <span class="nav-text">md5 加密——不可逆</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%B8%80%E7%A7%8D"><span class="nav-number">1.1.</span> <span class="nav-text">第一种</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%BA%8C%E7%A7%8D"><span class="nav-number">1.2.</span> <span class="nav-text">第二种</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#hmacsha-%E5%8A%A0%E5%AF%86%E2%80%94%E2%80%94%E4%B8%8D%E5%8F%AF%E9%80%86"><span class="nav-number">2.</span> <span class="nav-text">hmacsha 加密——不可逆</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#hmac-md5%E5%8A%A0%E5%AF%86"><span class="nav-number">2.1.</span> <span class="nav-text">hmac-md5加密</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#hamacsha1-%E5%8A%A0%E5%AF%86"><span class="nav-number">2.2.</span> <span class="nav-text">hamacsha1 加密</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#hamacsha-256-%E5%8A%A0%E5%AF%86"><span class="nav-number">2.3.</span> <span class="nav-text">hamacsha 256 加密</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#hmacsha512%E5%8A%A0%E5%AF%86"><span class="nav-number">2.4.</span> <span class="nav-text">hmacsha512加密</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#hamasha-%E8%B0%83%E7%94%A8"><span class="nav-number">2.5.</span> <span class="nav-text">hamasha 调用</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Sha-%E5%8A%A0%E5%AF%86%E2%80%94%E2%80%94%E4%B8%8D%E5%8F%AF%E9%80%86"><span class="nav-number">3.</span> <span class="nav-text">Sha 加密——不可逆</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#sha1"><span class="nav-number">3.1.</span> <span class="nav-text">sha1</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sha256"><span class="nav-number">3.2.</span> <span class="nav-text">sha256</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sha512"><span class="nav-number">3.3.</span> <span class="nav-text">sha512</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sha%E8%B0%83%E7%94%A8"><span class="nav-number">3.4.</span> <span class="nav-text">sha调用</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#base-%E5%8A%A0%E5%AF%86-%E8%A7%A3%E5%AF%86"><span class="nav-number">4.</span> <span class="nav-text">base 加密 解密</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8A%A0%E5%AF%86"><span class="nav-number">4.1.</span> <span class="nav-text">加密</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%A7%A3%E5%AF%86"><span class="nav-number">4.2.</span> <span class="nav-text">解密</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#base64-%E8%B0%83%E7%94%A8"><span class="nav-number">4.3.</span> <span class="nav-text">base64 调用</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#AES-%E5%8A%A0%E5%AF%86"><span class="nav-number">5.</span> <span class="nav-text">AES 加密</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#CBC%E6%96%B9%E5%BC%8F"><span class="nav-number">5.1.</span> <span class="nav-text">CBC方式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ECB%E6%96%B9%E5%BC%8F"><span class="nav-number">5.2.</span> <span class="nav-text">ECB方式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CFB-%E6%96%B9%E5%BC%8F"><span class="nav-number">5.3.</span> <span class="nav-text">CFB 方式</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#RSA%E5%8A%A0%E5%AF%86"><span class="nav-number">6.</span> <span class="nav-text">RSA加密</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#RSA%E5%8A%A0%E5%AF%86-1"><span class="nav-number">6.1.</span> <span class="nav-text">RSA加密</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#RSA%E5%88%86%E6%AE%B5%E5%8A%A0%E5%AF%86"><span class="nav-number">6.2.</span> <span class="nav-text">RSA分段加密</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#DES%E5%8A%A0%E5%AF%86"><span class="nav-number">7.</span> <span class="nav-text">DES加密</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%86%85%E7%BD%AE%E5%BA%93%E5%AE%8C%E6%88%90"><span class="nav-number">7.1.</span> <span class="nav-text">内置库完成</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93"><span class="nav-number">7.2.</span> <span class="nav-text">使用第三方库</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#3DES%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95"><span class="nav-number">8.</span> <span class="nav-text">3DES加密算法</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8C%85%E6%8B%AC-Des%E7%9A%84%E5%8A%A0%E5%AF%86%E8%A7%A3%E5%AF%86"><span class="nav-number">8.1.</span> <span class="nav-text">包括 Des的加密解密</span></a></li></ol></li></ol></div></div></div></div></div></div><div class="main-content-footer"><footer class="footer mt-5 py-5 h-auto text-base text-third-text-color relative border-t-2 border-t-border-color"><div class="info-container py-3 text-center"><div class="text-center">&copy; <span>2024</span> - 2024&nbsp;&nbsp;<i class="fa-solid fa-heart fa-beat" style="--fa-animation-duration:0.5s;color:#f54545"></i>&nbsp;&nbsp;<a href="/">流转</a><p class="post-count space-x-0.5"><span>共 24 篇文章 </span><span>共 27.9k 字</span></p></div><script data-swup-reload-script src="https://cn.vercount.one/js"></script><div class="relative text-center lg:absolute lg:right-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-right"><span id="busuanzi_container_site_uv" class="lg:!block"><span class="text-sm">访问人数</span> <span id="busuanzi_value_site_uv"></span> </span><span id="busuanzi_container_site_pv" class="lg:!block"><span class="text-sm">总访问量</span> <span id="busuanzi_value_site_pv"></span></span></div><div class="relative text-center lg:absolute lg:left-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-left"><span class="lg:block text-sm">由 <?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg class="relative top-[2px] inline-block align-baseline" version="1.1" id="圖層_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="1rem" height="1rem" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><path fill="#0E83CD" d="M256.4,25.8l-200,115.5L56,371.5l199.6,114.7l200-115.5l0.4-230.2L256.4,25.8z M349,354.6l-18.4,10.7l-18.6-11V275H200v79.6l-18.4,10.7l-18.6-11v-197l18.5-10.6l18.5,10.8V237h112v-79.6l18.5-10.6l18.5,10.8V354.6z"/></svg><a target="_blank" class="text-base" href="https://hexo.io">Hexo</a> 驱动</span> <span class="text-sm lg:block">主题&nbsp;<a class="text-base" target="_blank" href="https://github.com/EvanNotFound/hexo-theme-redefine">Redefine v2.6.4</a></span></div><div>博客已运行 <span class="odometer" id="runtime_days"></span> 天 <span class="odometer" id="runtime_hours"></span> 小时 <span class="odometer" id="runtime_minutes"></span> 分钟 <span class="odometer" id="runtime_seconds"></span> 秒</div><script data-swup-reload-script>try {
                    function odometer_init() {
                    const elements = document.querySelectorAll('.odometer');
                    elements.forEach(el => {
                        new Odometer({
                            el,
                            format: '( ddd).dd',
                            duration: 200
                        });
                    });
                    }
                    odometer_init();
                } catch (error) {}</script></div></footer><link rel="stylesheet" href="//cdn.bootcss.com/highlight.js/9.2.0/styles/github.min.css"><script src="//cdn.bootcss.com/highlight.js/9.2.0/highlight.min.js"></script><script>hljs.initHighlightingOnLoad()</script></div></div><div class="post-tools"><div class="post-tools-container"><ul class="article-tools-list"><li class="right-bottom-tools page-aside-toggle"><i class="fa-regular fa-outdent"></i></li><li class="go-comment"><i class="fa-regular fa-comments"></i></li></ul></div></div><div class="right-side-tools-container"><div class="side-tools-container"><ul class="hidden-tools-list"><li class="right-bottom-tools tool-font-adjust-plus flex justify-center items-center"><i class="fa-regular fa-magnifying-glass-plus"></i></li><li class="right-bottom-tools tool-font-adjust-minus flex justify-center items-center"><i class="fa-regular fa-magnifying-glass-minus"></i></li><li class="right-bottom-tools tool-dark-light-toggle flex justify-center items-center"><i class="fa-regular fa-moon"></i></li><li class="right-bottom-tools rss flex justify-center items-center"><a class="flex justify-center items-center" href="/atom.xml" target="_blank"><i class="fa-regular fa-rss"></i></a></li><li class="right-bottom-tools tool-scroll-to-bottom flex justify-center items-center"><i class="fa-regular fa-arrow-down"></i></li></ul><ul class="visible-tools-list"><li class="right-bottom-tools toggle-tools-list flex justify-center items-center"><i class="fa-regular fa-cog fa-spin"></i></li><li class="right-bottom-tools tool-scroll-to-top flex justify-center items-center"><i class="arrow-up fas fa-arrow-up"></i> <span class="percent"></span></li></ul></div></div><div class="image-viewer-container"><img src=""></div><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-input-field-pre"><i class="fa-solid fa-keyboard"></i></span><div class="search-input-container"><input autocomplete="off" autocorrect="off" autocapitalize="off" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa-solid fa-times"></i></span></div><div id="search-result"><div id="no-result"><i class="fa-solid fa-spinner fa-spin-pulse fa-5x fa-fw"></i></div></div></div></div></main><script src="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.6.4/source/js/libs/Swup.min.js"></script><script src="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.6.4/source/js/libs/SwupSlideTheme.min.js"></script><script src="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.6.4/source/js/libs/SwupScriptsPlugin.min.js"></script><script src="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.6.4/source/js/libs/SwupProgressPlugin.min.js"></script><script src="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.6.4/source/js/libs/SwupScrollPlugin.min.js"></script><script src="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.6.4/source/js/libs/SwupPreloadPlugin.min.js"></script><script>const swup = new Swup({
        plugins: [
            new SwupScriptsPlugin({
                optin: true,
            }),
            new SwupProgressPlugin(),
            new SwupScrollPlugin({
                offset: 80,
            }),
            new SwupSlideTheme({
                mainElement: ".main-content-body",
            }),
            new SwupPreloadPlugin(),
        ],
        containers: ["#swup"],
    });</script><script type="module" src="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.6.4/source/js/tools/imageViewer.js"></script><script type="module" src="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.6.4/source/js/utils.js"></script><script type="module" src="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.6.4/source/js/main.js"></script><script type="module" src="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.6.4/source/js/layouts/navbarShrink.js"></script><script type="module" src="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.6.4/source/js/tools/scrollTopBottom.js"></script><script type="module" src="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.6.4/source/js/tools/lightDarkSwitch.js"></script><script type="module" src="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.6.4/source/js/layouts/categoryList.js"></script><script type="module" src="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.6.4/source/js/tools/localSearch.js"></script><script type="module" src="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.6.4/source/js/tools/codeBlock.js"></script><script src="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.6.4/source/js/tools/runtime.js"></script><script src="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.6.4/source/js/libs/odometer.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.6.4/source/assets/odometer-theme-minimal.css"><script src="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.6.4/source/js/libs/Typed.min.js"></script><script type="module" src="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.6.4/source/js/plugins/typed.js"></script><script src="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.6.4/source/js/libs/minimasonry.min.js"></script><script type="module" src="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.6.4/source/js/plugins/masonry.js"></script><div class="post-scripts" data-swup-reload-script><script type="module" src="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.6.4/source/js/tools/tocToggle.js"></script><script type="module" src="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.6.4/source/js/layouts/toc.js"></script><script type="module" src="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.6.4/source/js/plugins/tabs.js"></script></div><div id="aplayer"></div><script src="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.6.4/source/js/libs/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.6.4/source/js/plugins/aplayer.js"></script></body></html>